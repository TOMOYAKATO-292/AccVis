交通事故ヒートマップ可視化 Web アプリ 要件定義書（MVP）

1. システム概要
   1.1 システム名（仮）

地方交通事故ヒートマップ可視化システム

1.2 目的

地方住民が、事故が多い道路や時間帯を直感的に把握し、危険な道路を避ける判断材料を提供する。

国土交通省および関係者が、事故の多発箇所と住民からの要望を可視化し、道路の対策・優先度付けの参考情報として利用できるようにする。

1.3 提供形態

Web ブラウザからアクセス可能な Web アプリケーション

シングルページ構成（Streamlit アプリ）

2. 前提・制約
   2.1 技術スタック

アプリケーションフレームワーク：Streamlit（Python）

地図・位置情報可視化：

Streamlit 標準機能（st.map、st.pydeck_chart を利用）

pydeck の HeatmapLayer / ScatterplotLayer 等によりヒートマップを描画

検索・位置指定の方法：

ユーザーは緯度・経度を直接入力する、または地図上で位置を指定する

住所 → 緯度経度変換（ジオコーディング）は行わない

データ形式：GeoJSON（事故データ可視化用）

永続データストア：

RDB 等のデータベースは使用しない

事故データセットおよびユーザー投稿データは、ファイルストレージ（例：S3 もしくはサーバーファイルシステム上の CSV/JSON/画像ファイル）で管理する前提

2.2 認証・認可

本 MVP ではログイン機能は実装しない

すべての利用者は同じ権限で機能を利用可能

将来的な国交省職員向け管理画面は範囲外

2.3 対象ブラウザ

PC ブラウザ（最新の Chrome / Edge を想定）

スマホ・タブレット対応はベストエフォート（完全最適化は MVP 範囲外）

3. 利用者とユースケース
   3.1 利用者

地方住民（一般ユーザー）

自宅周辺や通勤・通学ルートの事故多発箇所を知りたい

危険だと感じている場所について画像付きで要望を出したい

国土交通省・自治体職員（データ閲覧者）

住民からの要望が多い危険箇所を俯瞰して確認したい

事故多発エリアの傾向（時間帯・種類・天候）を把握したい

3.2 代表的なユースケース（MVP）
UC-01：事故ヒートマップ閲覧

ユーザーはトップ画面で 緯度・経度を入力する

または、地図上の任意位置をクリックして中心位置を指定する

指定された緯度経度を中心として地図が移動する

指定範囲の事故データがヒートマップとして表示される

ユーザーはズーム・パンで周辺の事故情報を確認する

ユーザーは年・月・時間帯、事故種類、天候でフィルタを変更し、ヒートマップの変化を確認する

UC-02：危険だと感じる地点の要望投稿

ユーザーは地図の任意地点をクリックする、または緯度・経度を入力して地点を指定する

要望投稿フォームにて以下を入力する

対象地点（緯度・経度）

要望内容（テキスト）

事故の実際の画像（任意）

送信ボタン押下で、テキストと画像がサーバ側に保存される

送信完了メッセージを表示する

4. 機能要件（MVP）
   4.1 トップ画面／共通画面
   F-001 緯度・経度入力機能

ユーザーはテキストボックス等で 緯度（latitude） と 経度（longitude） を数値として入力できる

入力値のバリデーション：

緯度：-90〜90

経度：-180〜180

「移動」ボタンにより、指定した緯度経度を地図の中心に反映する

F-002 地図上での位置指定

ユーザーは地図上をクリックすることで中心位置（緯度・経度）を指定できる

クリックした地点の緯度・経度を取得し、画面上に表示する

例：サイドバーやフォームに「選択中の地点（緯度・経度）」として反映

F-003 地図表示

Streamlit の地図描画機能（st.pydeck_chart など）を利用して、地図を表示する

初期表示位置：

アプリ初回ロード時は日本全体 or デフォルト地域を表示

緯度・経度入力、または地図クリックにより中心が変更された場合、その位置を中心に再表示する

F-004 地図操作（ズーム／パン）

ユーザーはマウス操作などで地図の拡大・縮小ができる

ユーザーはドラッグにより表示範囲を移動できる

4.2 ヒートマップ表示
F-010 ヒートマップ描画

地図上に事故データを基にしたヒートマップを表示する

Streamlit の st.pydeck_chart ＋ HeatmapLayer を用いて実装する想定

ヒートマップは、表示中の地図範囲内の事故データを対象とする

ヒートマップの色濃度は、事故件数（密度）に応じて変化させる

F-011 表示更新

緯度・経度入力や地図クリックにより地図中心が変わった場合、該当エリアの事故データでヒートマップを再描画する

フィルタ条件（時間範囲／事故種類／天候）が変更された場合、ヒートマップ表示を更新する

4.3 フィルタリング機能
F-020 時間範囲フィルタ

ユーザーは以下の条件で事故データを絞り込みできる：

年：複数年から選択 or 指定年のみ（MVP では単一選択で良い）

月：1〜12 月のプルダウン

時間帯：例）0–6 時、6–12 時、12–18 時、18–24 時 等の範囲選択

未選択時は「全期間」扱いとする

F-021 事故種類フィルタ

事故の種類（例：追突、出会い頭、歩行者事故 等）をリスト表示し、複数選択可能とする

未選択時は「全種類」を対象とする

F-022 天候フィルタ

天候（例：晴れ、雨、雪、その他）を複数選択可能とする

未選択時は「全天候」を対象とする

4.4 事故情報の詳細確認（MVP 範囲の最小）
F-030 事故ポイントの簡易情報表示

ヒートマップだけではなく、任意地点をクリックした際にその周辺の事故概要を簡易表示する（任意／簡易でよい）

表示項目（例）：

事故件数

代表的な事故種類上位 1〜3

代表的な時間帯

※本 MVP では個別事故レコードを 1 件ずつリスト表示する機能は必須としない（負荷や UI 複雑化を避けるため）

4.5 要望投稿機能
F-040 要望投稿フォーム表示

画面上部 or サイドバーに「要望を送る」ボタンを配置する

クリック時に要望投稿フォームを表示する（モーダル or ページ内）

F-041 要望投稿内容入力

入力項目：

対象地点：

地図上のクリックで地点を選択し、その緯度・経度を利用
または、ユーザーが直接入力した緯度・経度を利用

要望内容（テキスト、必須）

任意で住所（テキスト） ※住所はあくまで補足情報として任意

事故の実際の画像（任意、1 ファイル）

画像ファイル：

形式：JPEG / PNG（MVP ではこの 2 種類）

サイズ上限：例）5MB 程度（値は実装時に決定）

F-042 要望投稿の保存

送信ボタン押下時、以下を保存する：

要望 ID（システムで採番、連番 or UUID）

送信日時（タイムスタンプ）

対象地点（緯度・経度）

テキスト要望内容

住所（任意）

画像ファイルパス（アップロードされた場合）

保存先：

JSON/CSV ファイル＋画像ファイルとしてサーバー（または S3）に保存する

RDB などのデータベースは利用しない

F-043 送信完了メッセージ

正常に保存できた場合、「要望を受け付けました」等のメッセージを表示

エラー時は「送信に失敗しました。時間をおいて再度お試しください」等のメッセージを表示する

※MVP では要望一覧の閲覧画面は必須ではない（将来の管理画面で実装予定）

5. データ要件
   5.1 事故データセット（入力データ）
   5.1.1 データ形式

フォーマット：GeoJSON または CSV ＋別途ジオ情報を変換

重複カット済みの事故データセットを前提とする

5.1.2 項目（最低限）

事故 ID（一意の識別子）

タイムスタンプ（発生日時）

緯度（latitude）

経度（longitude）

天候（例：晴れ、雨、雪、その他）

事故の種類（カテゴリ名）

（任意）都道府県名、市区町村名

（任意）道路種別（国道、県道、市道 等）

5.1.3 更新

MVP では、手動で更新された静的ファイルをアプリサーバー or S3 に置き、起動時に読み込む想定

リアルタイム更新は範囲外

データはファイルから読み取る形式を取る

5.2 要望投稿データ

要望 ID

送信日時

対象地点（緯度・経度）

要望テキスト

住所（任意）

添付画像ファイルパス（任意）
